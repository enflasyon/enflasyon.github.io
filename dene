from selenium import webdriver
from selenium.webdriver.common.by import By
from datetime import datetime, timedelta
import time

# Chrome driver'ı başlat
options = webdriver.ChromeOptions()
options.add_argument("--headless")  # görünmez çalıştırmak için (istersen çıkarabilirsin)
driver = webdriver.Chrome(options=options)

# Rapor URL'si
url = ".Günlük%20Giris-Cikis%20Raporu"
driver.get(url)

time.sleep(5)  # tablo yüklenmesi için bekle

# Tablo içinden giriş zamanı hücresini bul (örn: 06:57:00 formatı)
giris_element = driver.find_element(By.XPATH, "//td[contains(text(), ':')]")
giris_saati_str = giris_element.text.strip()

# String -> datetime
giris_saati = datetime.strptime(giris_saati_str, "%H:%M:%S")

# 9 saat 15 dk ekle
cikis_saati = giris_saati + timedelta(hours=9, minutes=15)

# Şu anki saat
simdi = datetime.now()
fark = cikis_saati - simdi

print("Giriş Zamanı :", giris_saati.time())
print("Tahmini Çıkış Zamanı :", cikis_saati.time())
print("Kalan Süre :", fark)

driver.quit()